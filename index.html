<html>
  <head>
    <!-- Web Receiver SDK -->
    <script src="//www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>
    <!-- Cast Debug Logger -->
    <script src="//www.gstatic.com/cast/sdk/libs/devtools/debug_layer/caf_receiver_logger.js"></script>

  </head>
  <body style="background-color:gray;">
    <!-- the only player -->
    <video id="videoPlayer"></video>

    <script>
      function initPlayer(){
        //
        var my_namespace ="urn:x-cast:custom_namespace";
        // get player reference
        var videoPlayer = document.getElementById('videoPlayer');
        // hide built in controller
        videoPlayer.controls = false;

        // Create the CastDebugLogger object and enable the logger:
        const castDebugLogger = cast.debug.CastDebugLogger.getInstance();
        const context = cast.framework.CastReceiverContext.getInstance();
        context.addEventListener(cast.framework.system.EventType.READY, () => {
          if (!castDebugLogger.debugOverlayElement_) {
              // Enable debug logger and show a 'DEBUG MODE' overlay at top left corner.
              castDebugLogger.setEnabled(true);
          }
        });

        castDebugLogger.loggerLevelByEvents = {
          'cast.framework.events.category.CORE': cast.framework.LoggerLevel.INFO,
          'cast.framework.events.EventType.MEDIA_STATUS': cast.framework.LoggerLevel.DEBUG
        }

        context.addEventListener(cast.framework.system.EventType.READY, () => {
          if (!castDebugLogger.debugOverlayElement_) {
              // Enable debug logger and show a 'DEBUG MODE' overlay at top left corner.
              castDebugLogger.setEnabled(true);
              // Show debug overlay
              castDebugLogger.showDebugLogs(true);
              // Clear log messages on debug overlay
              castDebugLogger.clearDebugLogs();
          }
        });




        // Initializes system manager and media manager, so that receiver app can receive requests from senders
        cast.framework.CastReceiverContext.getInstance().start();
        // enable debug logging
        cast.framework.CastReceiverContext.getInstance().setLoggerLevel(cast.framework.LoggerLevel.DEBUG);
        // Retrieve the current cast session, then Add an event listener to the defined namespace channel
        cast.framework.CastReceiverContext.getInstance().getCurrentSession()
          .addMessageListener(my_namespace, (namespace, message) => {
            const fromServer = JSON.parse(message); 
            switch(message.subject){
              case "play":
                // Set player's source
                videoPlayer.src = message.video_source;
                // Resets the media to the beginning and selects the best available source
                videoPlayer.load();
                // Begins playback of the media
                videoPlayer.play();
                break;
              default:
            }
          })
      }
      window.onload = initPlayer();
    </script>
  </body>
</html>